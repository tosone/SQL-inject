_jsload&&_jsload('poly', 'r.extend(b3.prototype,{initialize:function(e){if(e&&this._graphMouseEvent){e.addEventListener("onmousemove",this._graphMouseEvent)}return I.prototype.initialize.call(this,e)},_addDom:function(){var e=this._drawer=bO.getDrawer(this.map);this.domElement=e.addLine()},_bind:function(){var e=this.domElement;var i=this;function b7(cd,cb){var ca=cd.srcElement||cd.target;var b9=b4();var b8=cd.pageX?cd.pageX:(cd.clientX+b9[1]);var cf=cd.pageY?cd.pageY:(cd.clientY+b9[0]);if(cd&&cb&&b8&&cf&&ca){var cc=r.I(ca.hashCode).map;var ce=r.Dom.getOffset(cc.container);cb.pixel=new aT(b8-ce.left,cf-ce.top);cb.point=cc.pixelToPoint(cb.pixel);return cb}else{return cb}}if(bO.getDrawer(this.map).getType()!="canvas"){r.on(e,"click",function(b8){i.dispatchEvent(b7(b8,new aM("onclick").inherit(b8)))});r.on(e,"mousedown",function(b8){i.dispatchEvent(b7(b8,new aM("onmousedown").inherit(b8)))});r.on(e,"mouseup",function(b8){i.dispatchEvent(b7(b8,new aM("onmouseup").inherit(b8)))});r.on(e,"dblclick",function(b8){i.dispatchEvent(b7(b8,new aM("ondblclick").inherit(b8)))})}e=null;if(!this._binded){this._binded=true;this._graphMouseEvent=function(cc){if(!i.map){return}if(i.map.getMapType()==="B_EARTH_MAP"){return}if(i instanceof b1.PolylineMultipart){return}if(i.map.temp._draggingMarker){return}var b9;if(cc.overlay&&cc.overlay.toString()==="Marker"){if(!cc.overlay.keepWhenMousemoveOn){if(i._temp.ismouseout===false&&i._temp.ismouseover===true){i._temp.ismouseover=false;i._temp.ismouseout=true;b9=new aM("onmouseout");i.dispatchEvent(b9)}return}}var b8=cc.point;var cb=i._getProximity(b8);var ca=parseFloat(cb.dist);if(ca<i._config.mouseOverTolerance){if(!i._temp.ismouseover){i._temp.ismouseover=true;i._temp.ismouseout=false;b9=new aM("onmouseover")}else{b9=new aM("onmousemove")}}else{if(!i._temp.ismouseout&&i._temp.ismouseover){i._temp.ismouseover=false;i._temp.ismouseout=true;b9=new aM("onmouseout")}}if(b9){if(i.toString()!="Polyline"&&b9.type=="onmousemove"&&i._temp.ismouseover==true&&(ca==0||ca>i._config.mouseOverTolerance)){b9.pixel=cc.pixel;b9.point=cc.point}else{b9.point=this.overlayPixelToPoint(cb.pixel);b9.pixel=this.pointToPixel(b9.point)}i.dispatchEvent(b9)}};this.map.addEventListener("onmousemove",this._graphMouseEvent);this.addEventListener("mouseover",function(b8){if(!this.map){return}if(this._config.enableEditing){this.addVertexs()}});this.addEventListener("mouseout",function(b8){if(!this.map){return}if(this._config.enableEditing&&!this._editstate){this.clearVertexs()}})}},draw:function(){if(!this.domElement){return}var i=this.map;if(i.getMapType()==="B_EARTH_MAP"){return}var e=this._getDisplayPixels(this.points);if(this._drawer){this._drawer.setPath(this.domElement,e)}},_draw:function(){if(this.map){this.initialize(this.map);this.domElement.style.WebkitUserSelect="none";this.draw()}},_getDisplayPixels:function(cg){var e=this.map,cf=[];if(cg.length==0||!this.domElement||!this.isVisible()){return[cf]}if(!this._config.enableEditing&&this._config.enableParse){var cd=this.getParseCacheIndex(e.getZoom());if(this._parseCache[cd]){cg=this._parseCache[cd]}else{var ch=bx(cg,this.getParseTolerance(e.getZoom(),e.config.coordType));cg=this._parseCache[cd]=ch}}var ce;var cc=e.pointToOverlayPixel(cg[0]);cf.push(cc);if(cc.onBack){ce=true}for(var ca=1,b8=1,b7=cg.length;ca<b7;ca++){var cb=e.pointToOverlayPixel(cg[ca],null);if(cb.onBack){ce=true}if(!cb.equals(cf[b8-1])){cf.push(cb);b8++}}var b9=[cf];b9.isOnBack=ce;return b9},getParseCacheIndex:function(e){if(this._config.getParseCacheIndex){return this._config.getParseCacheIndex(e)}if(e<6){return 0}if(e<10){return 1}if(e<15){return 2}return 3},getParseTolerance:function(i,e){if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return b3.parseTolerance[e][this.getParseCacheIndex(i)]},setPoints:function(e){this._parseCache.length=0;this.points=b3.getGraphPoints(e).slice(0);this._calcBounds();this.draw();this.dispatchEvent(new aM("onlineupdate"))},setPointAt:function(i,e){if(!e||!this.points[i]){return}this._parseCache.length=0;this.points[i]=new bv(e.lng,e.lat);this._calcBounds();this.draw();this.dispatchEvent(new aM("onlineupdate"))},setStrokeColor:function(e){if(this._config){this._config.strokeColor=e}this._setDomAttribute("strokecolor",e);this.dispatchEvent(new aM("onlineupdate"))},setStrokeLineCap:function(e){if(this._config){this._config.strokeLineCap=e}this._setDomAttribute("strokelinecap",e);this.dispatchEvent(new aM("onlineupdate"))},setStrokeLineJoin:function(e){if(this._config){this._config.strokeLineJoin=e}this._setDomAttribute("strokelinejoin",e);this.dispatchEvent(new aM("onlineupdate"))},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e;this._setDomAttribute("strokeweight",e);if(this.getStrokeStyle()=="dashed"&&bO.getDrawer(this.map).getType()=="svg"){this._setDomAttribute("strokestyle","dashed")}}this.dispatchEvent(new aM("onlineupdate"))},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e;if(!this.map){return}this._setDomAttribute("strokeopacity",e)},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this._setDomAttribute("fillopacity",e)},setStrokeStyle:function(e){if(e!="solid"&&e!="dashed"&&e!="dotted"){return}this._config.strokeStyle=e;this._setDomAttribute("strokestyle",e)},setFillColor:function(e){this._config.fillColor=e||"";this._setDomAttribute("fillcolor",e)},getStrokeLineCap:function(){if(this._config){return this._config.strokeLineCap}},getStrokeLineJoin:function(){if(this._config){return this._config.strokeLineJoin}},_setDomAttribute:function(e,i){if(this._drawer){this._drawer.setAttribute(this.domElement,e,i||"",this.getStrokeWeight())}this.dispatchEvent(new aM("onlineupdate"))},addVertexs:function(){var cc=this;if(cc.vertexMarkers.length){return}var cd=this.getVertexPoints();var cb;for(var ca=0,b8=cd.length;ca<b8;ca++){var e=cd[ca];if(e.t){cb=bu.imgPath+"nodeT.gif"}else{cb=bu.imgPath+"node.gif"}var b7=new D(cb,new aj(11,11),{offset:new aj(5,5)});var b9=new L(e.p,{icon:b7});b9.enableDragging(true);b9.addEventListener("ondragging",function(i){cc._onMarkerDragging(i)});b9.addEventListener("ondragstart",function(i){cc._onMarkerDragstart(i)});b9.addEventListener("ondragend",function(i){cc._onMarkerDragend(i)});b9.index=ca;b9.t=e.t;this.vertexMarkers.push(b9);this.map.addOverlay(b9)}},clearVertexs:function(){var e;while(e=this.vertexMarkers.pop()){this.map.removeOverlay(e);delete e}this.vertexMarkers.length=0},getVertexPoints:function(){var ca=[];for(var b9=0,b7=this.points.length;b9<b7;b9++){var cb=this.points[b9];ca.push({p:cb,t:0});if(b9<b7-1){var e=this.points[b9+1];var b8=new bv((cb.lng+e.lng)/2,(cb.lat+e.lat)/2);ca.push({p:b8,t:1})}}this.vertexPoints=ca;return ca},_onMarkerDragstart:function(i){this._editstate=false},_onMarkerDragend:function(cb){this.vertexPoints.length=0;this._editstate=false;if(this._temp.dashedLine){this.map.removeOverlay(this._temp.dashedLine);delete this._temp.dashedLine}if(this._temp.preTNode){this.map.removeOverlay(this._temp.preTNode);delete this._temp.preTNode}if(this._temp.nexTNode){this.map.removeOverlay(this._temp.nexTNode);delete this._temp.nexTNode}var ca=cb.currentTarget;var cc=cb.point;var i=ca.index;var b9;if(i%2!=0){i=Math.ceil(i/2);b9=this.points.slice();var b8=this.points.length-i;var b7=b9.splice(i,b8);b9[b9.length]=cc;b9=b9.concat(b7)}else{i=i/2;this.points.splice(i,1,cc);if(this instanceof bC&&this.points.length-1==i){this.points.splice(0,1,cc)}b9=this.points}this.clearVertexs();this.setPoints(b9);this.addVertexs()},_getProximity:function(cj){var b7,b9,ck,cc,cb,ci,ch,cg=[];var co=this.map.pointToOverlayPixel(cj);cg=this._getDisplayPixels(this.points)[0];var cr=cg.length;if(cr>1){for(var cp=1;cp<cr;cp++){var ce=cg[cp-1];var cv=cg[cp];if(!ce||!cv){continue}if(ce.x!=cv.x){var cu=(cv.y-ce.y)/(cv.x-ce.x);var cs=cv.y-cu*cv.x;ch=Math.abs(cu*co.x+cs-co.y)/Math.sqrt(cu*cu+1)}else{ch=Math.abs(co.x-cv.x)}var cq=Math.pow(cv.y-ce.y,2)+Math.pow(cv.x-ce.x,2);var b8=Math.pow(cv.y-co.y,2)+Math.pow(cv.x-co.x,2);var ct=Math.pow(ce.y-co.y,2)+Math.pow(ce.x-co.x,2);var ca=Math.pow(ch,2);var e=b8-ca+ct-ca;if(e>cq){ch=Math.sqrt(Math.min(b8,ct))}if((b7==null)||(b7>ch)){b9=Math.sqrt(ct-ca)/Math.sqrt(cq);ck=Math.sqrt(b8-ca)/Math.sqrt(cq);b7=ch;ci=cp}b7=Math.min(b7,ch)}if(this.toString()!="Polyline"){var cm=0,cl=0,cn=this.points;for(var cp=0;cp<cr;cp++){cm=(cp==cr-1)?0:cm+1;if((cn[cp].lat!=cn[cm].lat)&&(((cj.lat>=cn[cp].lat)&&(cj.lat<cn[cm].lat))||((cj.lat>=cn[cm].lat)&&(cj.lat<cn[cp].lat)))&&(cj.lng<(cn[cm].lng-cn[cp].lng)*(cj.lat-cn[cp].lat)/(cn[cm].lat-cn[cp].lat)+cn[cp].lng)){cl++}}b7=Math.min(b7,cl%2>0?0:b7)}if(b9>1){b9=1}if(ck>1){b9=0;ck=1}var cf=cg[ci-1].x-cg[ci].x;var cd=cg[ci-1].y-cg[ci].y;cc=cg[ci-1].x-(cf*b9);cb=cg[ci-1].y-(cd*b9)}return{pixel:new aT(cc,cb),dist:b7}},show:function(){I.prototype.show.call(this);this.dispatchEvent(new aM("onlineupdate"))},hide:function(){I.prototype.hide.call(this);this.dispatchEvent(new aM("onlineupdate"))}});function aR(ca,b8,ch){var ce=false,cc=false,cf=false,cj=new aT(ca.x,ca.y),ci=new aT(b8.x,b8.y),b9=aD(cj,ch),b7=aD(ci,ch),cg;var cl,ck;var cd=ch.minX,cb=ch.minY,i=ch.maxX,e=ch.maxY;do{if(b9.all==0&&b7.all==0){ce=true;cf=true}else{if((b9.all&b7.all)!=0){cf=true}else{if(b9.all!=0){cg=b9}else{cg=b7}if(cg.top){cl=cj.x+(ci.x-cj.x)*(cb-cj.y)/(ci.y-cj.y);ck=cb}else{if(cg.bottom){cl=cj.x+(ci.x-cj.x)*(e-cj.y)/(ci.y-cj.y);ck=e}else{if(cg.right){ck=cj.y+(ci.y-cj.y)*(i-cj.x)/(ci.x-cj.x);cl=i}else{if(cg.left){ck=cj.y+(ci.y-cj.y)*(cd-cj.x)/(ci.x-cj.x);cl=cd}}}}cc=true;if(cg.all==b9.all){cj.x=Math.round(cl);cj.y=Math.round(ck);b9=aD(cj,ch)}else{ci.x=Math.round(cl);ci.y=Math.round(ck);b7=aD(ci,ch)}}}}while(!cf);if(ce){return{pixel0:new aT(cj.x,cj.y),pixel1:new aT(ci.x,ci.y),clip:cc?true:false}}}function aD(i,b9){var b7={top:0,bottom:0,right:0,left:0,all:0};var e=i.x,b8=i.y;if(b8<b9.minY){b7.top=8;b7.all+=b7.top}else{if(b8>b9.maxY){b7.bottom=4;b7.all+=b7.bottom}}if(e>b9.maxX){b7.right=2;b7.all+=b7.right}else{if(e<b9.minX){b7.left=1;b7.all+=b7.left}}return b7}r.extend(k.prototype,{initialize:function(e){b3.prototype.initialize.call(this,e);this.setFillColor("");this.setStrokeColor(this._config.strokeColor);this.setStrokeWeight(this._config.strokeWeight);this.setStrokeStyle(this._config.strokeStyle);this.setStrokeLineCap(this._config.strokeLineCap);this.setStrokeLineJoin(this._config.strokeLineJoin);this.setStrokeOpacity(this._config.strokeOpacity);return this.domElement},_getDisplayPixels:function(cj){var co=this.map;var b9=[];if(cj.length===0||!this.domElement||!this.isVisible()){return[b9]}if(!((r.Platform.ipad||r.Platform.iphone||r.Platform.android)&&cj.length>5000)&&!this._config.enableEditing){var ca=this.getParseCacheIndex(co.getZoom());if(this._parseCache[ca]){cj=this._parseCache[ca]}else{var e=bx(cj,this.getParseTolerance(co.getZoom(),co.config.coordType));cj=this._parseCache[ca]=e}}var cn;var cp=co.pointToOverlayPixel(cj[0]);b9.push(cp);if(cp.onBack){cn=true}for(var ck=1,ch=1,cg=cj.length;ck<cg;ck++){var b8=co.pointToOverlayPixel(cj[ck]);if(b8.onBack){cn=true}if(!b8.equals(b9[ch-1])){b9.push(b8);ch++}}var cm=[];var ce=co.offsetX;var cd=co.offsetY;var cc=co.config.drawMargin;var cb={minX:-ce-cc,minY:-cd-cc,maxX:-ce+cc+co.width,maxY:-cd+cc+co.height};for(ck=0,cg=b9.length-1;ck<cg;ck++){var cl=b9[ck];var ci=b9[ck+1];var b7=aR(cl,ci,cb);if(b7){cm.push(b7)}}var cf=[[]];for(ck=0,cg=cm.length;ck<cg;ck++){if(cm[ck].clip){cf[cf.length-1].push(cm[ck].pixel0);cf[cf.length-1].push(cm[ck].pixel1);if(cm[ck+1]&&cm[ck+1].clip){cf.push([])}}else{cf[cf.length-1].push(cm[ck].pixel0);if(ck===cm.length-1){cf[cf.length-1].push(cm[ck].pixel1)}}}cf.isOnBack=cn;return cf},_onMarkerDragging:function(ce){this._editstate=true;var b7=ce.currentTarget;var cg=ce.point;var cf=b7.index;var i=this.vertexPoints;var ch;var cc=null;var b8=null;if(cf===0){var cd=i[cf+2].p;ch=[cg,cd];cc=new bv((cd.lng+cg.lng)/2,(cd.lat+cg.lat)/2);if(this.vertexMarkers[cf+1]){this.vertexMarkers[cf+1].hide()}}else{if(cf===i.length-1){var cb=i[cf-2].p;ch=[cb,cg];cc=new bv((cb.lng+cg.lng)/2,(cb.lat+cg.lat)/2);if(this.vertexMarkers[cf-1]){this.vertexMarkers[cf-1].hide()}}else{var cb=i[cf-1].p;var cd=i[cf+1].p;ch=[cb,cg,cd];if(!b7.t){cb=i[cf-2].p;cd=i[cf+2].p;ch=[cb,cg,cd];cc=new bv((cb.lng+cg.lng)/2,(cb.lat+cg.lat)/2);b8=new bv((cd.lng+cg.lng)/2,(cd.lat+cg.lat)/2);if(this.vertexMarkers[cf-1]){this.vertexMarkers[cf-1].hide()}if(this.vertexMarkers[cf+1]){this.vertexMarkers[cf+1].hide()}}}}if(!this._temp.dashedLine){var ca=new k(ch,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(ca);ca.hide();this._temp.dashedLine=ca}else{this._temp.dashedLine.setPoints(ch);this._temp.dashedLine.show()}var b9=new D(bu.imgPath+"nodeT.gif",new aj(11,11),{offset:new aj(5,5)});if(!this._temp.preTNode&&cc){this._temp.preTNode=new L(cc,{icon:b9});this.map.addOverlay(this._temp.preTNode)}else{if(cc){this._temp.preTNode.setPoint(cc)}}if(!this._temp.nexTNode&&b8){this._temp.nexTNode=new L(b8,{icon:b9});this.map.addOverlay(this._temp.nexTNode)}else{if(b8){this._temp.nexTNode.setPoint(b8)}}}});r.extend(ai.prototype,{_getDisplayPixels:function(e){var b7=[];var i=this;var b8;r.each(e,function(b9){var ca=i._getEachDisplayPixels(b9);if(ca.isOnBack){b8=true}r.each(ca,function(cb){b7.push(cb)})});b7.isOnBack=b8;return b7},_getEachDisplayPixels:function(ch){var cn=this.map;var b9=[];if(ch.length===0||!this.domElement||!this.isVisible()){return[b9]}if(!((r.Platform.ipad||r.Platform.iphone||r.Platform.android)&&ch.length>5000)&&!this._config.enableEditing){var e=bx(ch,this.getParseTolerance(cn.getZoom(),cn.config.coordType));ch=e}var cm;var co=cn.pointToOverlayPixel(ch[0]);b9.push(co);if(co.onBack){cm=true}for(var cj=1,cg=1,cf=ch.length;cj<cf;cj++){var b8=cn.pointToOverlayPixel(ch[cj]);if(b8.onBack){cm=true}if(!b8.equals(b9[cg-1])){b9.push(b8);cg++}}var cl=[];var cd=cn.offsetX;var cc=cn.offsetY;var cb=cn.config.drawMargin;var ca={minX:-cd-cb,minY:-cc-cb,maxX:-cd+cb+cn.width,maxY:-cc+cb+cn.height};for(cj=0,cf=b9.length-1;cj<cf;cj++){var ck=b9[cj];var ci=b9[cj+1];var b7=aR(ck,ci,ca);if(b7){cl.push(b7)}}var ce=[[]];for(cj=0,cf=cl.length;cj<cf;cj++){if(cl[cj].clip){ce[ce.length-1].push(cl[cj].pixel0);ce[ce.length-1].push(cl[cj].pixel1);if(cl[cj+1]&&cl[cj+1].clip){ce.push([])}}else{ce[ce.length-1].push(cl[cj].pixel0);if(cj===cl.length-1){ce[ce.length-1].push(cl[cj].pixel1)}}}ce.isOnBack=cm;return ce},getParsedPoints:function(){var b8=this.map;var i=this.points;var e=[];var b7=this;r.each(i,function(ca){var b9=bx(ca,b7.getParseTolerance(b8.getZoom(),b8.config.coordType));e.push(b9)});return e}});r.extend(bC.prototype,{initialize:function(e){b3.prototype.initialize.call(this,e);this.setStrokeColor(this._config.strokeColor);this.setStrokeWeight(this._config.strokeWeight);this.setStrokeStyle(this._config.strokeStyle);this.setFillColor(this._config.fillColor);this.setStrokeOpacity(this._config.strokeOpacity);this.setFillOpacity(this._config.fillOpacity);return this.domElement},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._userPoints[i]=new bv(e.lng,e.lat);this.points[i]=new bv(e.lng,e.lat);if(i==0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new bv(e.lng,e.lat)}this._calcBounds();this.draw();this.dispatchEvent(new aM("onlineupdate"))},_onMarkerDragging:function(cf){this._editstate=true;var b8=cf.currentTarget;var ch=cf.point;var cg=b8.index;var i=this.vertexPoints;var cj;var cc=i[1].p;var ci=i[i.length-1].p;var cd=null,b7=null;if(cg==0){var ce=i[cg+1].p;cj=[ci,ch,ce];if(!b8.t){cd=new bv((ci.lng+ch.lng)/2,(ci.lat+ch.lat)/2);b7=new bv((ce.lng+ch.lng)/2,(ce.lat+ch.lat)/2)}}else{if(cg==i.length-1){var cb=i[cg-1].p;cj=[cb,ch,cc];if(!b8.t){cd=new bv((cb.lng+ch.lng)/2,(cb.lat+ch.lat)/2);b7=new bv((cc.lng+ch.lng)/2,(cc.lat+ch.lat)/2)}}else{var cb=i[cg-1].p;var ce=i[cg+1].p;cj=[cb,ch,ce];if(!b8.t){cb=i[cg-2].p;ce=i[cg+2].p;cj=[cb,ch,ce];cd=new bv((cb.lng+ch.lng)/2,(cb.lat+ch.lat)/2);b7=new bv((ce.lng+ch.lng)/2,(ce.lat+ch.lat)/2);if(this.vertexMarkers[cg-1]){this.vertexMarkers[cg-1].hide()}if(this.vertexMarkers[cg+1]){this.vertexMarkers[cg+1].hide()}}}}if(!this._temp.dashedLine){var ca=new k(cj,{strokeStyle:"dashed",strokeColor:this._config.strokeColor,strokeWeight:this._config.strokeWeight,strokeOpacity:this._config.strokeOpacity});this.map.addOverlay(ca);this._temp.dashedLine=ca}else{this._temp.dashedLine.setPoints(cj)}var b9=new D(bu.imgPath+"nodeT.gif",new aj(11,11),{offset:new aj(5,5)});if(!this._temp.preTNode&&cd){this._temp.preTNode=new L(cd,{icon:b9});this.map.addOverlay(this._temp.preTNode)}else{if(cd){this._temp.preTNode.setPoint(cd)}}if(!this._temp.nexTNode&&b7){this._temp.nexTNode=new L(b7,{icon:b9});this.map.addOverlay(this._temp.nexTNode)}else{if(b7){this._temp.nexTNode.setPoint(b7)}}}});r.extend(a.prototype,{initialize:function(e){bC.prototype.initialize.call(this,e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return this.domElement},setPoint:function(e,i){if(!e){return}this._parseCache.length=0;if(!i){this.vertexPoints=null}this.point=e;this.points=this._getPerimeterPoints(e,this.radius);this._calcBounds();this.draw();this.dispatchEvent(new aM("onlineupdate"))},setRadius:function(e,i){this._parseCache.length=0;if(!i){this.vertexPoints=null}this.radius=Math.abs(e);this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();this.draw();this.dispatchEvent(new aM("onlineupdate"))},getParseTolerance:function(i,e){if(this._config.getParseTolerance){return this._config.getParseTolerance(i,e)}return a.parseTolerance[e][this.getParseCacheIndex(i)]},_onMarkerDragging:function(cb){var b9,cd,ce,i=this.map;this._editstate=true;var b8=cb.currentTarget;var cc=b8.index;var b7=this.vertexPoints;var ca=b7[0].p;var cf=b7[b7.length-1].p;if(cc==0){cd=b8.point;ce=cf}else{cd=ca;ce=b8.point}b9=aE.getDistanceByMC(cd,ce);this.setRadius(b9,true);this.setCenter(cd,true)},_onMarkerDragend:function(b8){this._editstate=false;var b7=b8.currentTarget;var i=b7.index;this.vertexPoints[0]={p:this.point,t:0};if(i==1){this.vertexPoints[1]={p:b7.point,t:0}}this.clearVertexs();this.addVertexs()},getVertexPoints:function(){if(!this.vertexPoints){var e=[];e.push({p:this.point,t:0});e.push({p:this.points[Math.floor(this.points.length*3/4)],t:0});this.vertexPoints=e}return this.vertexPoints}});function ar(e){this._map=e;this._canvasAttrName={strokeweight:"lineWidth",strokecolor:"strokeStyle",fillcolor:"fillStyle",strokeopacity:"globalAlpha",fillopacity:"globalAlpha"};this._type="canvas"}ar.prototype=new am();var bs=ar.prototype;bs.addLine=function(){var i=J("canvas");this._map.getPanes().mapPane.appendChild(i);i.style.position="absolute";var e=i.getContext("2d");e.lineCap="round";e.lineJoin="round";e.save();return i};bs.setPath=function(b7,i){if(!b7){return}var e=b7.getContext("2d");this._setCanvasPosition(b7);this._clearCanvas(e);var b9=parseInt(b7.style.top),b8=parseInt(b7.style.left);e.beginPath();r.each(i,function(cc){if(cc.length==0){return}e.moveTo(cc[0].x-b8,cc[0].y-b9);for(var cb=1,ca=cc.length;cb<ca;cb++){e.lineTo(cc[cb].x-b8,cc[cb].y-b9)}});this._drawCanvas(b7)};bs.setAttribute=function(b9,b7,ca){if(!b9){return}var i=b9.getContext("2d");var b8=this._getAttributeName(b7);try{i[b8]=ca}catch(cb){}b9.setAttribute("_"+b7,ca||"");i.save();this._clearCanvas(i);this._drawCanvas(b9)};bs._getAttributeName=function(e){return this._canvasAttrName[e]||e};bs._setCanvasPosition=function(b9){var i=this._map,ce=i.config.drawMargin,b7=i.width+2*ce,cb=i.height+2*ce,b8=-i.offsetX-ce,ca=-i.offsetY-ce,cd=b9.getContext("2d"),cc={strokeStyle:cd.strokeStyle,fillStyle:cd.fillStyle,globalAlpha:cd.globalAlpha,lineWidth:cd.lineWidth,lineCap:"round",lineJoin:"round"};b9.setAttribute("width",b7);b9.setAttribute("height",cb);for(var e in cc){cd[e]=cc[e]}cd.save();var cf=b9.style;cf.top=ca+"px";cf.left=b8+"px"};bs._clearCanvas=function(e){e.clearRect(0,0,9999,9999)};bs._drawCanvas=function(i){var e=i.getContext("2d");e.globalAlpha=i.getAttribute("_fillopacity");if(e.globalAlpha!=0&&i.getAttribute("_fillcolor")){e.fill()}e.globalAlpha=i.getAttribute("_strokeopacity");if(e.globalAlpha!=0&&i.getAttribute("_strokecolor")){e.stroke()}};function am(){}DrawerPrototype=am.prototype;DrawerPrototype.setPalette=function(){};DrawerPrototype.addLine=function(){throw"addLine接口没有实现"};DrawerPrototype.setAttribute=function(){throw"setAttribute接口没有实现"};DrawerPrototype.setPath=function(){throw"setPath接口没有实现"};DrawerPrototype.getType=function(){return this._type};var bO={getDrawer:function(e){if(!bO["_"+e.hashCode]){bO["_"+e.hashCode]={}}switch(e.config.drawer){case BMAP_SVG_DRAWER:return bO.getSvgDrawer(e);case BMAP_VML_DRAWER:return bO.getVmlDrawer(e);case BMAP_CANVAS_DRAWER:return bO.getCanvasDrawer(e);default:break}if(bO.isSupportSvg()){return bO.getSvgDrawer(e)}if(bO.isSupportVml()){return bO.getVmlDrawer(e)}if(bO.isSupportCanvas()){return bO.getCanvasDrawer(e)}},getSvgDrawer:function(e){if(!bO["_"+e.hashCode]._svgDrawer){bO["_"+e.hashCode]._svgDrawer=new aK(e)}return bO["_"+e.hashCode]._svgDrawer},getVmlDrawer:function(e){if(!bO["_"+e.hashCode]._vmlDrawer){bO["_"+e.hashCode]._vmlDrawer=new bg(e)}return bO["_"+e.hashCode]._vmlDrawer},getCanvasDrawer:function(e){if(!bO["_"+e.hashCode]._canvasDrawer){bO["_"+e.hashCode]._canvasDrawer=new ar(e)}return bO["_"+e.hashCode]._canvasDrawer},isSupportVml:function(){if(typeof bO.supportVml!="undefined"){return bO.supportVml}var b7=document.body.appendChild(J("div"));b7.innerHTML=\'<v:shape id="vml_tester1" adj="1" />\';var i=b7.firstChild;if(!i.style){return false}i.style.behavior="url(#default#VML)";var e=i?typeof i.adj=="object":true;b7.parentNode.removeChild(b7);bO.supportVml=e;return e},isSupportSvg:function(){if(typeof bO.supportSvg=="undefined"){bO.supportSvg=!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")}return bO.supportSvg},isSupportCanvas:function(){if(typeof bO.supportCanvas=="undefined"){bO.supportCanvas=!!J("canvas").getContext}return bO.supportCanvas}};b1.DrawerSelector=bO;function aK(e){this._map=e;this.SVG_NS="http://www.w3.org/2000/svg";this._svgAttrName={strokeweight:"stroke-width",strokecolor:"stroke",fillcolor:"fill",strokeopacity:"stroke-opacity",fillopacity:"fill-opacity",strokestyle:"stroke-dasharray",strokelinecap:"stroke-linecap",strokelinejoin:"stroke-linejoin"};this._svg=this._createSvg();this._type="svg"}aK.prototype=new am();var v=aK.prototype;v._createSvg=function(){var e=this._svg=J("svg",{},this.SVG_NS);e.setAttribute("version","1.1");e.setAttribute("type","system");var i=e.style;i.position="absolute";this.setPalette();this._map.getPanes().mapPane.appendChild(e);return e};v.setPalette=function(){if(!this._svg){return}var b7=this._svg,cc=this._map,i=cc.config.drawMargin,b9=cc.width+2*i,e=cc.height+2*i,cb=-cc.offsetX-i,ca=-cc.offsetY-i;this.setAttribute(b7,"x",b9+"px");this.setAttribute(b7,"y",e+"px");this.setAttribute(b7,"viewBox",cb+" "+ca+" "+b9+" "+e);var b8=b7.style;b8.top=ca+"px";b8.left=cb+"px";b8.width=b9+"px";b8.height=e+"px"};v.getPalette=function(){return this._svg};v.setAttribute=function(b7,e,b8,i){if(!b7){return}if(e=="strokestyle"){switch(b8){case"dashed":b8=i*2;break;case"dotted":b8="1,"+i*2;break;default:b8=0;break}}var b9=b8||"none";b7.setAttributeNS(null,this._getAttributeName(e),b9);return b7};v._getAttributeName=function(e){return this._svgAttrName[e]||e};v.addLine=function(){var e=J("path",{},this.SVG_NS);this.setAttribute(e,"fill-rule","evenodd");this._svg.appendChild(e);return e};v.setPath=function(b7,e){var i=this._getPathString(e)||"M -9999,-9999";this.setAttribute(b7,"d",i)};v._getPathString=function(e){if(e.length==0){return""}var i=[];r.each(e,function(b9){if(b9.length<2){return}i.push("M "+b9[0].x+" "+b9[0].y+" L");for(var b8=1,b7=b9.length;b8<b7;b8++){i.push(b9[b8].x);i.push(b9[b8].y)}});return i.join(" ")};function bg(e){this._map=e;this._vmlAttrName={strokeweight:"weight",strokecolor:"color",fillcolor:"color",strokeopacity:"opacity",fillopacity:"opacity",strokestyle:"dashstyle"};this._type="vml"}bg.prototype=new am();var aW=bg.prototype;aW.setAttribute=function(b7,e,b8){if(b7){if(e.indexOf("stroke")==0){b7=b7.getElementsByTagName("stroke")[0]}else{if(e.indexOf("fill")==0){b7=b7.getElementsByTagName("fill")[0]}}if(e.indexOf("color")>0){if(!b8){b7.on=false}else{b7.on=true}}if(e=="strokestyle"){switch(b8){case"dashed":b8="4 2 1 2";break;case"dotted":b8="1 1";break;default:b8="solid";break}}if(e=="strokeweight"){b8=b8+"px"}var i=this._getAttributeName(e);b7[i]=b8||""}};aW._getAttributeName=function(e){return this._vmlAttrName[e]||e};aW.addLine=function(){var e=[\'<v:shape style="behavior:url(#default#VML);z-index:1;width:1px;height:1px;position:absolute;left:0;top:0;"\',\'coordsize="1,1" coordorigin="0,0" filled="t" fillcolor="white">\',\'<v:stroke style="behavior:url(#default#VML);" endcap="round" oned="true" />\',\'<v:fill style="behavior:url(#default#VML)" />\',"</v:shape>"].join("");return W(this._map.getPanes().mapPane,e)};aW.setPath=function(i,e){this.setAttribute(i,"path",this._getPathString(e));if(r.Browser.ie==6){i.style.display="none";i.style.display=""}};aW._getPathString=function(e){if(e.length==0){return""}var i=[];r.each(e,function(b9){if(b9.length<2){return}i.push("m "+b9[0].x+" "+b9[0].y+" l");for(var b8=1,b7=b9.length;b8<b7;b8++){i.push(b9[b8].x);i.push(b9[b8].y)}i.push("e")});return i.join(" ")||" "};');
﻿_jsload&&_jsload('hotspot', 'b1.register(function(b7){if(b7.config&&b7.config.isOverviewMap){return}function e(b8,ce){var cg=[];for(var ca in b8.spotsPool){var cd=b8.spotsPool[ca];for(var cc=0,cb=cd.length;cc<cb;cc++){var cf=cd[cc];if(cf.lr&&(b8.getZoom()<cf.lr[0]||b8.getZoom()>cf.lr[1])){continue}var b9=b8.pointToPixel(cf.pt);if(b9.x<b8.width&&b9.y<b8.height){if((ce.offsetX-b9.x<cf.bd[2]&&ce.offsetX-b9.x>cf.bd[0])&&(b9.y-ce.offsetY<cf.bd[3]&&b9.y-ce.offsetY>cf.bd[1])){b8.platform.style.cursor="pointer";cg.push(cf)}}}}return cg}b7.addEventListener("mousemove",function(co){if(this.getMapType()===BMAP_EARTH_MAP){return}if(co.overlay&&!(co.overlay instanceof b3)||co.infoWindow){return}var cf=this.temp;if(cf.spottimer){clearTimeout(cf.spottimer);cf.spottimer=null}if(!(b7.currentOperation&aO.drag)){if(b7.spotsPool){var cc=b7.temp.curSpots.slice(0);b7.temp.curSpots=[];for(var cg in b7.spotsPool){var cn=b7.spotsPool[cg];var b8=cn.spots.slice(0);b7.temp.curSpots[cn.zIndex]={spots:[],enableMultiResponse:cn.enableMultiResponse};for(var cm=0,cj=b8.length;cm<cj;cm++){var cd=b8[cm];if(cd.lr&&(b7.getZoom()<cd.lr[0]||b7.getZoom()>cd.lr[1])){continue}var ca=b7.pointToPixel(cd.pt);if(ca.x<b7.width&&ca.y<b7.height){if((co.offsetX-ca.x<cd.bd[2]&&co.offsetX-ca.x>cd.bd[0])&&(ca.y-co.offsetY<cd.bd[3]&&ca.y-co.offsetY>cd.bd[1])){b7.platform.style.cursor="pointer";cd._distance=bQ(ca,new aT(co.offsetX,co.offsetY));b7.temp.curSpots[cn.zIndex].spots.push(cd)}}}}b7.temp.curSpotsArray=[];for(var cm=b7.temp.curSpots.length-1;cm>=0;cm--){if(b7.temp.curSpots[cm]&&b7.temp.curSpots[cm].spots&&b7.temp.curSpots[cm].spots.length>0){b7.temp.curSpotsArray=b7.temp.curSpots[cm].spots;break}}var cb=b7.temp.curSpotsArray.slice(0);var ce=[];var cp=cm;for(var cm=cc.length-1;cm>=0;cm--){if(cm==cp){ce=cc[cp]&&cc[cp].spots||[];for(var cl=0,cj=ce.length;cl<cj;cl++){for(var ck=0,ch=0,ci=b7.temp.curSpotsArray.length;ck<ci;ck++,ch++){if(ce[cl]===b7.temp.curSpotsArray[ck]){ce.splice(cl,1);cl--;cb.splice(ch,1);ch--}}}}else{if(cc[cm]&&cc[cm].spots&&cc[cm].spots.length>0){for(var cl=0;cl<cc[cm].spots.length;cl++){ce.push(cc[cm].spots[cl])}}}}if(ce.length>0){var b9=new aM("onspotmouseout");b9.spots=ce.slice(0);b7.dispatchEvent(b9)}if(b7.temp.curSpotsArray.length==0){if(b7.platform.style.cursor!=b7.config.defaultCursor){b7.platform.style.cursor=b7.config.defaultCursor}}else{if(cb.length>0){var b9=new aM("onspotmouseover");if(b7.temp.curSpots[b7.temp.curSpots.length-1].enableMultiResponse){b9.spots=cb.slice(0)}else{cb.sort(function(cr,cq){return cr._distance-cq._distance});b9.spots=cb.slice(0,1)}b9.point=new bv(co.point.lng,co.point.lat);b9.pixel=new aT(co.pixel.x,co.pixel.y);b7.dispatchEvent(b9)}}}}});b7.addEventListener("click",function(cc){var ca=this.temp;if(cc.overlay&&!(cc.overlay instanceof bC)){return}if(r.Platform.iphone||r.Platform.ipad||r.Platform.android){ca.curSpots=e(b7,cc)}var cb=new aM("onspotclick");if(ca.curSpotsArray.length>0){for(var b9=0,b8=ca.curSpots.length;b9<b8;b9++){if(ca.curSpots[b9].spots&&ca.curSpots[b9].spots.length>0){if(ca.curSpots[b9].enableMultiResponse){cb.spots=ca.curSpotsArray.slice(0)}else{ca.curSpotsArray.sort(function(ce,cd){return ce._distance-cd._distance});cb.spots=ca.curSpotsArray.slice(0,1)}break}}cb.point=new bv(cc.point.lng,cc.point.lat);cb.pixel=new aT(cc.pixel.x,cc.pixel.y)}this.dispatchEvent(cb)});function i(){if(b7.temp.__dragged==true){b7.temp.__dragged=false}else{b7.temp.curSpots=[];b7.platform.style.cursor=b7.config.defaultCursor}}b7.addEventListener("load",i);b7.addEventListener("moveend",i);b7.addEventListener("zoomend",i);b7.addEventListener("dragend",function(){this.temp.__dragged=true})});');
